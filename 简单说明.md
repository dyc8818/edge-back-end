# git
## 1. 克隆与分支
1. 请使用SSH克隆，不要使用HTTPS克隆

   github账户添加SSH key请自行查询
    ```
    git clone git@github.com:dyc8818/edge-back-end.git
    ```
2. 创建dev分支关联远程的dev分支

   （第一次clone后才需要这么做，以后不必）

    ```shell
    git checkout -b dev origin/dev
    ```
3. 开发时请务必**保持在dev分支**，查看分支请使用
    ```
    git branch
    ```
4. 若不是dev分支，切换分支请使用
    ```
    git checkout dev
    ```
5. 每次启动IDE后先更新下代码可以更好地避免冲突
    ```
    git pull
    ```

## 2. 更新与提交

1. 先添加文件
    ```
    git add . 
    ```
2. 本地提交更新
    ```
    git commit -m "更新说明"
    ```
3. 同步远端代码
    ```
    git pull
    ```
4. 向远端仓库推送更新
    ```
    git push
    ```
## 3. 远端仓库关联相关
由于之前项目从gitee迁移到github，如果之前是在gitee推送的话，需要更改关联的远端仓库。

github账号及SSH key相关设定好之后，就可以更改关联的远端仓库了

可以先查看目前的关联情况
```
git remote -v
```
移除旧仓库，一般情况下叫origin，如果不是的话请记得调整命令
```
git remote rm origin
```
关联新仓库
```
git remote add origin git@github.com:dyc8818/edge-back-end.git
```
P.S. 当然重新克隆也是可以的
## 4. git基本操作
```
git add .

git commit  -m "评论"

git push 提交

git reset 版本号 --hard
```


# 后端

## 依赖

maven

pom.xml（已经配置好）

## 配置

application.yml（已经配置好）主要配置数据库信息

## 结构

- pom.xml 存放maven的依赖包

- resources里的application.yml存放配置

- **1.entity层** 

  存放实体类

  需要添加**@Document**注解

- **2.dao层**

  dao层主要做数据持久层的工作，负责与数据库进行联络的一些任务都封装在此，dao层的设计首先是设计dao层的接口，然后在Spring的配置文件中定义此接口的实现类，然后就可以再模块中调用此接口来进行数据业务的处理，而不用关心此接口的具体实现类是哪个类，显得结构非常清晰，dao层的数据源配置，以及有关数据库连接参数都在Spring配置文件中进行配置。

- **3.service**

  service层主要负责业务模块的应用逻辑应用设计。同样是首先设计接口，再设计其实现类，接着再Spring的配置文件中配置其实现的关联。这样我们就可以在应用中调用service接口来进行业务处理。service层的业务实，具体要调用已经定义的dao层接口，封装service层业务逻辑有利于通用的业务逻辑的独立性和重复利用性。程序显得非常简洁。

  **需要添加@Service注解**

- **4.controller层**

  controller层负责具体的业务模块流程的控制，在此层要调用service层的接口来控制业务流程，控制的配置也同样是在Spring的配置文件里进行，针对具体的业务流程，会有不同的控制器。我们具体的设计过程可以将流程进行抽象归纳，设计出可以重复利用的子单元流程模块。这样不仅使程序结构变得清晰，也大大减少了代码量。

  需要添加**@Controller**注解

## 3.4 postman测试

## 3.5 步骤

1. entity文件夹下建立实体类对应数据库表

   @Document注解在类上

   @Id 

2. 建立dao层

3. 建立service接口和实现，实现用@Service注解

4. 建立controller层（@Controller、@RequestMapping、@RequestBody、@ResponseBody）@RequestParam）

   引入service和dao中的类时需要@Autowired注解，不用new

## 3.5 命名规范 

驼峰法

# 前端

## thymeleaf

模板

## layui

table

form

ajax

## controller

api

pages

# MQ
目前依赖ActiveMQ，没有MQ无法启动，请先去官网下载安装。

<http://activemq.apache.org/>

"Classic"版本足矣。
解压即可。

## Windows环境启动
windows系统下 去根目录/bin/win64（或32）/，直接运行**activemq.bat**。
cmd窗口不要关。访问localhost:8161能出管理界面就说明运行成功，可以跑后端了。
## Linux环境启动
Linux系统下，去根目录里面的bin文件夹下，终端执行
```bash activemq start```
即可启动，启动完成后可以关掉终端。能访问localhost:8161就说明成功。

# Linux
注意：在命令前后加上  "nohup 某命令 &"  的意思是你关闭当前的命令行窗口，服务器的程序不会中断

lsof -i:8080    查看占用端口为8080的程序，可以查到pid，进程id
然后用进程id可以将这个进程杀死    kill 9 进程id

ls 列举当前目录所有文件

用ssh 登陆  :
    ssh edgex@202.112.146.168   
    pw:edgex1234
 ## 运行edgex
    开启edgex后台
     cd /home/edgex/go/src/github.com/edgexfoundry/edgex-go/
    nohup make run &

    开启edgex自带界面
     cd /home/edgex/go/src/github.com/edgexfoundry/edgex-ui-go
     nohup make run &

    开启modbus
      cd /home/edgex/go/src/github.com/edgexfoundry/device-modbus-go/bin
      sudo nohup ./edgex-launch.sh &

     账号密码是admin admin
     访问  http://202.112.146.168:4000/
     运行规则引擎
     cd /home/edgex/go/src/github.com/edgexfoundry/support-rulesengine
      mvn spring-boot:run
 ## 运行 后台代码
 cd WorkSpace/java/edge-back-end/
 mvn spring-boot:run
 
 
    

